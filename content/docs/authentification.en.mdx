---
title: Authentication
description: Complete authentication system in Swell with Laravel 12 - login, register, forgot password, email verification and profile management.
---

## Complete authentication system

**Swell** integrates a modern and secure authentication system based on Laravel 12, offering all essential features to manage users in your e-commerce application.

The system covers the entire user lifecycle: registration, login, email verification, password recovery and profile management.

## Authentication features

### Registration (Register)

Registration allows new users to create an account with data validation and optional email verification.

**Route:** `GET /register` and `POST /register`

**Required fields:**
- Name
- Email address (unique)
- Password (with confirmation)

```php title="app/Http/Controllers/Auth/RegisteredController.php"
public function store(Request $request): RedirectResponse
{
    $request->validate([
        'name' => 'required|string|max:255',
        'email' => 'required|string|lowercase|email|max:255|unique:'.User::class,
        'password' => ['required', 'confirmed', Rules\Password::defaults()],
    ], [
        'name.required' => 'Name is required',
        'name.max' => 'Name cannot exceed 255 characters',
        'email.required' => 'Email address is required',
        'email.email' => 'Email address must be valid',
        'email.lowercase' => 'Email address must be lowercase',
        'email.max' => 'Email address cannot exceed 255 characters',
        'email.unique' => 'This email address is already in use',
        'password.required' => 'Password is required',
        'password.confirmed' => 'Password confirmation does not match',
    ]);

    $user = User::create([
        'name' => $request->name,
        'email' => $request->email,
        'password' => Hash::make($request->password),
    ]);

    event(new Registered($user));

    Auth::login($user);

    return redirect()->intended(route('dashboard', absolute: false));
}
```

### Login

Login supports email/password authentication with "Remember me" option and protection against brute force attacks.

**Route:** `GET /login` and `POST /login`

```php title="app/Http/Controllers/Auth/AuthenticatedSessionController.php"
public function store(LoginRequest $request): RedirectResponse
{
    $request->authenticate();

    $request->session()->regenerate();

    return redirect()->intended(route('dashboard', absolute: false));
}
```

**Attack protection:**
- Rate limiting
- Temporary lockout after repeated failures

### Forgot Password

Password recovery system via email with secure tokens and expiration.

**Reset request:**

```php title="app/Http/Controllers/Auth/PasswordResetLinkController.php"
public function store(Request $request): RedirectResponse
{
    $request->validate([
        'email' => 'required|email',
    ]);

    Password::sendResetLink(
        $request->only('email')
    );

    return back()->with('status', __('A reset link will be sent if the account exists.'));
}
```

**Password reset:**

```php title="app/Http/Controllers/Auth/NewPasswordController.php"
public function store(Request $request): RedirectResponse
{
    $request->validate([
        'token' => 'required',
        'email' => 'required|email',
        'password' => ['required', 'confirmed', Rules\Password::defaults()],
    ]);

    $status = Password::reset(
        $request->only('email', 'password', 'password_confirmation', 'token'),
        function ($user) use ($request) {
            $user->forceFill([
                'password' => Hash::make($request->password),
                'remember_token' => Str::random(60),
            ])->save();

            event(new PasswordReset($user));
        }
    );

    if ($status == Password::PASSWORD_RESET) {
        return to_route('login')->with('status', __($status));
    }

    throw ValidationException::withMessages([
        'email' => [__($status)],
    ]);
}
```

### Email Verification

Mandatory or optional email verification system depending on pages via middleware.

**Verification middleware:**

```php title="app/Http/Middleware/EnsureEmailIsVerified.php"
public function handle($request, Closure $next, $redirectToRoute = null)
{
    if (! $request->user() ||
        ($request->user() instanceof MustVerifyEmail &&
        ! $request->user()->hasVerifiedEmail())) {
        return $request->expectsJson()
            ? abort(403, 'Your email address is not verified.')
            : Redirect::guest(URL::route($redirectToRoute ?: 'verification.notice'));
    }

    return $next($request);
}
```

**Resend verification email:**

```php title="app/Http/Controllers/Auth/EmailVerificationNotificationController.php"
public function store(Request $request): RedirectResponse
{
    if ($request->user()->hasVerifiedEmail()) {
        return redirect()->intended(route('dashboard', absolute: false));
    }

    $request->user()->sendEmailVerificationNotification();

    return back()->with('status', 'verification-link-sent');
}
```

## User profile management

### Updating personal information

```php title="app/Http/Controllers/Settings/ProfileController.php"
public function update(ProfileUpdateRequest $request): RedirectResponse
{
    $request->user()->fill($request->validated());

    if ($request->user()->isDirty('email')) {
        $request->user()->email_verified_at = null;
    }

    if ($request->hasFile('avatar')) {
        $request->user()->update(['avatar' => $request->file('avatar')->store('avatars', 'public')]);
    }

    $request->user()->save();

    return to_route('profile.edit');
}
```

### Password change

```php title="app/Http/Controllers/Settings/PasswordController.php"
public function update(Request $request): RedirectResponse
{
    $validated = $request->validate([
        'current_password' => ['required', 'current_password'],
        'password' => ['required', Password::defaults(), 'confirmed'],
    ]);

    $request->user()->update([
        'password' => Hash::make($validated['password']),
    ]);

    return back();
}
```

### Account deletion

```php title="app/Http/Controllers/Settings/ProfileController.php"
public function destroy(Request $request): RedirectResponse
{
    $request->validate([
        'password' => ['required', 'current_password'],
    ]);

    $user = $request->user();

    Auth::logout();

    $user->delete();

    $request->session()->invalidate();
    $request->session()->regenerateToken();

    return redirect('/');
}
```

## Configuration and security

### Environment variables

```bash title=".env"
# Session
SESSION_LIFETIME=120
SESSION_ENCRYPT=true
SESSION_SECURE_COOKIE=true
```

### Security middleware

**Authenticated route protection:**

```php title="routes/web.php"
Route::middleware(['auth', 'verified'])->group(function () {
    Route::get('/dashboard', [DashboardController::class, 'index'])->name('dashboard');
    Route::get('/profile', [ProfileController::class, 'edit'])->name('profile.edit');
});
```

## User interface

### React authentication components

Swell provides ready-to-use React components for all authentication features:

- `auth/login` - Login page
- `auth/register` - Registration page  
- `auth/forgot-password` - Password reset page
- `auth/reset-password` - New password
- `auth/verify-email` - Email verification prompt
- `settings/profile` - Profile editing
- `settings/password` - Password change

### Authentication layouts

Several layouts are available depending on the desired design:

```tsx title="resources/js/layouts/auth/"
- auth-card-layout.tsx
- auth-simple-layout.tsx
- auth-split-layout.tsx
```

<Callout>
    More info in the [Laravel](https://laravel.com/starter-kits) documentation
</Callout>

## Tests

Swell includes a complete test suite for authentication in the `tests/Feature/Auth/` folder.

### Test structure

```
tests/Feature/Auth/
├── AuthenticationTest.php          # Login/logout tests
├── EmailVerificationTest.php       # Email verification tests
├── PasswordConfirmationTest.php    # Password confirmation tests
├── PasswordResetTest.php           # Reset tests
├── RegistrationTest.php            # Registration tests
```

### Test examples

**Registration test:**

```php title="tests/Feature/Auth/RegistrationTest.php"
test('new users can register', function () {
    $response = $this->post('/register', [
        'name' => 'Test User',
        'email' => 'test@example.com',
        'password' => 'password',
        'password_confirmation' => 'password',
    ]);

    $this->assertAuthenticated();
    $response->assertRedirect(route('dashboard', absolute: false));
});
```

**Login test:**

```php title="tests/Feature/Auth/AuthenticationTest.php"
test('users can authenticate using the login screen', function () {
    $user = User::factory()->create();

    $response = $this->post('/login', [
        'email' => $user->email,
        'password' => 'password',
    ]);

    $this->assertAuthenticated();
    $response->assertRedirect(route('dashboard', absolute: false));
});
```

### Running tests

```bash
# All authentication tests
php artisan test tests/Feature/Auth/

# Specific test
php artisan test tests/Feature/Auth/RegistrationTest.php

# With code coverage
php artisan test --coverage tests/Feature/Auth/
```

Tests cover all scenarios: login, registration, password recovery, email verification and profile management with validation of error and success cases.